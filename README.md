# NVD CVE API Search

## Version 240703

[![ThreatReport](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/ThreatReport.yml/badge.svg?branch=main)](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/ThreatReport.yml)

[![pages-build-deployment](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/pages/pages-build-deployment/badge.svg)](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/pages/pages-build-deployment)

[![Pylint](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/PyLint.yml/badge.svg)](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/PyLint.yml)

Searches NVD CVE API for CVEs containing specified keywords, exporting them to a convenient CSV file, after checking for duplicates

See [example output](cve_unduped.csv)

To use, fork or clone repo

If Forking: See [Workflow YML](.github/workflows/ThreatReport.yml)

## GH Environment Setup

Make Github Environment CI with 2 Secrets: TEAMS_HOOK for MS Teams Webhook, and NVD_API_KEY for NVD CVE API, which is publically available by request

NVD API key is recommended, so you do not get rate-limited between requests

Teams Webhook only needed for alert

## GH Pages

GitHub Pages deploys from ['/docs'](docs/) directory for ease of use, explore the [Web Demo](https://securitytapestry-queen.github.io/nvd-cve-api-search/index.html)

## General Notes

Array of keywords for search defined in test_array

```python
test_array = ['PHP','Windows','Dell']
```

Requires Python 3.11.4+ and the below packages

openpyxl==3.1.5

pandas==2.2.2

pytz==2024.1

requests==2.32.3

```bash
pip3 install -r requirements.txt
```

## Example Mini CSV Report

(outputs to csv_unduped.csv)

```bash
python3 search.py -m
```

## Usage

```bash
usage: search.py [-h] [-m] [-M] [-test] [-t] [-html] [-a]

NVD CVE API Scraping Bot

options:
  -h, --help            show this help message and exit
  -m, --mini-csv        Only checks for a few CVEs per Search Term
  -M, --maxi-csv        Full-Sized Search
  -test, --testing      Test Search
  -t, --send-to-teams   Sends Link to Teams Channel
  -html, --html-tables  Converts Output CSV to HTML Tables
  -a, --archiver        Archives CSV
```

## Archive

Located [here](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/tree/main/archive), the archive folder is created if it does not exist, and each run is stored conveniently, with the most recent CSV
