# NVD CVE API Search

[![ThreatReport](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/ThreatReport.yml/badge.svg?branch=main)](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/ThreatReport.yml)

[![pages-build-deployment](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/pages/pages-build-deployment/badge.svg)](https://github.com/SecurityTapestry-Queen/nvd-cve-api-search/actions/workflows/pages/pages-build-deployment)

Searches NVD CVE API for CVEs containing specified keywords, exporting them to a convenient CSV file, after checking for duplicates

See [example output](cve_unduped.csv)

To use, fork or clone repo

If Forking: See [Workflow YML](.github/workflows/ThreatReport.yml)


# GH Environment Setup
Make Github Environment CI with 2 Secrets: TEAMS_HOOK for MS Teams Webhook, and NVD_API_KEY for NVD CVE API, which is publically available by request

NVD API key is recommended, so you do not get rate-limited between requests

Teams Webhook only needed for alert


# General Notes
Array of keywords for search defined in kwArray

```python
kwArray = ['Apple','IBM','Microsoft']
```
Requires Python 3.10.8 and the below packages

openpyxl==3.1.2
pandas==1.5.3
pytz==2022.7.1
requests==2.28.1
```
pip3 install -r requirements.txt
```
# Example Mini CSV Report
(outputs to csv_unduped.csv)
```
python3 search.py -m
```

# Usage
```
usage: search.py [-h] [-m] [-M] [-t] [-html] [-e] [-a]

NVD CVE API Scraper

options:
  -h, --help            show this help message and exit
  -m, --mini-csv        Only checks for a few CVEs per Search Term
  -M, --maxi-csv        Full-Sized Search
  -t, --send-to-teams   Sends Link to Teams Channel
  -html, --html-tables  Converts Output CSV to HTML Tables
  -e, --excel           Converts final CSV to Excel file
  -a, --archiver        Archives XLSX and HTML
```